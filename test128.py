from scipy.misc import imread,imsave
from numpy import zeros
import numpy as np


a={' ':0,'!':1,'"':2,'#':3,'$':4,'%':5,'&':6,"'":7,'(':8,')':9,'*':10,'+':11,',':12,'-':13,'.':14, '/':15, '0':16, '1':17,'2':18,'3':19,'4':20,'5':21,'6':22,'7':23,'8':24,'9':25,':':26, ';':27, '<':28, '=':29, '>':30, '?':31, '@':32, 'A':33, 'B':34, 'C':35, 'D':36, 'E':37, 'F':38, 'G':39, 'H':40, 'I':41, 'J':42, 'K':43, 'L':44, 'M':45, 'N':46, 'O':47, 'P':48, 'Q':49, 'R':50, 'S':51, 'T':52, 'U':53, 'V':54, 'W':55, 'X':56, 'Y':57, 'Z':58, '[':59, '\\':60, ']':61, '^':62, '_':63, 'NUL':64, 'SOH':65, 'STX':66, 'ETX':67, 'EOT':68, 'ENQ':69, 'ACK':70, 'BEL':71, 'BS':72, 'HT':73, 'LF':74, 'VT':75, 'FF':76, 'CR':77, 'SO':78, 'SI':79, 'DLE':80, 'DC1':81, 'DC2':82, 'DC3':83, 'DC4':84, 'NAK':85, 'SYN':86, 'ETB':87, 'CAN':88, 'EM':89, 'SUB':90, 'ESC':91, 'FS':92, 'GS':93, 'RS':94, 'US':95, 'FNC3':96, 'FNC2':97, 'SHIFT':98, 'CODE_C':99, 'CODE_B':100, 'FNC4':101, 'FNC1':102, 'START_A':103, 'START_B':104, 'START_C':105, 'STOP':106}
code128=np.zeros((107, 11),dtype=np.uint8)
code128[0]=(1,1,0,1,1,0,0,1,1,0,0)
code128[1]=(1,1,0,0,1,1,0,1,1,0,0)
code128[2]=(1,1,0,0,1,1,0,0,1,1,0)
code128[3]=(1,0,0,1,0,0,1,1,0,0,0)
code128[4]=(1,0,0,1,0,0,0,1,1,0,0)
code128[5]=(1,0,0,0,1,0,0,1,1,0,0)
code128[6]=(1,0,0,1,1,0,0,1,0,0,0)
code128[7]=(1,0,0,1,1,0,0,0,1,0,0)
code128[8]=(1,0,0,0,1,1,0,0,1,0,0)
code128[9]=(1,1,0,0,1,0,0,1,0,0,0)
code128[10]=(1,1,0,0,1,0,0,0,1,0,0)
code128[11]=(1,1,0,0,0,1,0,0,1,0,0)
code128[12]=(1,0,1,1,0,0,1,1,1,0,0)
code128[13]=(1,0,0,1,1,0,1,1,1,0,0)
code128[14]=(1,0,0,1,1,0,0,1,1,1,0)
code128[15]=(1,0,1,1,1,0,0,1,1,0,0)
code128[16]=(1,0,0,1,1,1,0,1,1,0,0)
code128[17]=(1,0,0,1,1,1,0,0,1,1,0)
code128[18]=(1,1,0,0,1,1,1,0,0,1,0)
code128[19]=(1,1,0,0,1,0,1,1,1,0,0)
code128[20]=(1,1,0,0,1,0,0,1,1,1,0)
code128[21]=(1,1,0,1,1,1,0,0,1,0,0)
code128[22]=(1,1,0,0,1,1,1,0,1,0,0)
code128[23]=(1,1,1,0,1,1,0,1,1,1,0)
code128[24]=(1,1,1,0,1,0,0,1,1,0,0)
code128[25]=(1,1,1,0,0,1,0,1,1,0,0)
code128[26]=(1,1,1,0,0,1,0,0,1,1,0)
code128[27]=(1,1,1,0,1,1,0,0,1,0,0)
code128[28]=(1,1,1,0,0,1,1,0,1,0,0)
code128[29]=(1,1,1,0,0,1,1,0,0,1,0)
code128[30]=(1,1,0,1,1,0,1,1,0,0,0)
code128[31]=(1,1,0,1,1,0,0,0,1,1,0)
code128[32]=(1,1,0,0,0,1,1,0,1,1,0)
code128[33]=(1,0,1,0,0,0,1,1,0,0,0)
code128[34]=(1,0,0,0,1,0,1,1,0,0,0)
code128[35]=(1,0,0,0,1,0,0,0,1,1,0)
code128[36]=(1,0,1,1,0,0,0,1,0,0,0)
code128[37]=(1,0,0,0,1,1,0,1,0,0,0)
code128[38]=(1,0,0,0,1,1,0,0,0,1,0)
code128[39]=(1,1,0,1,0,0,0,1,0,0,0)
code128[40]=(1,1,0,0,0,1,0,1,0,0,0)
code128[41]=(1,1,0,0,0,1,0,0,0,1,0)
code128[42]=(1,0,1,1,0,1,1,1,0,0,0)
code128[43]=(1,0,1,1,0,0,0,1,1,1,0)
code128[44]=(1,0,0,0,1,1,0,1,1,1,0)
code128[45]=(1,0,1,1,1,0,1,1,0,0,0)
code128[46]=(1,0,1,1,1,0,0,0,1,1,0)
code128[47]=(1,0,0,0,1,1,1,0,1,1,0)
code128[48]=(1,1,1,0,1,1,1,0,1,1,0)
code128[49]=(1,1,0,1,0,0,0,1,1,1,0)
code128[50]=(1,1,0,0,0,1,0,1,1,1,0)
code128[51]=(1,1,0,1,1,1,0,1,0,0,0)
code128[52]=(1,1,0,1,1,1,0,0,0,1,0)
code128[53]=(1,1,0,1,1,1,0,1,1,1,0)
code128[54]=(1,1,1,0,1,0,1,1,0,0,0)
code128[55]=(1,1,1,0,1,0,0,0,1,1,0)
code128[56]=(1,1,1,0,0,0,1,0,1,1,0)
code128[57]=(1,1,1,0,1,1,0,1,0,0,0)
code128[58]=(1,1,1,0,1,1,0,0,0,1,0)
code128[59]=(1,1,1,0,0,0,1,1,0,1,0)
code128[60]=(1,1,1,0,1,1,1,1,0,1,0)
code128[61]=(1,1,0,0,1,0,0,0,0,1,0)
code128[62]=(1,1,1,1,0,0,0,1,0,1,0)
code128[63]=(1,0,1,0,0,1,1,0,0,0,0)
code128[64]=(1,0,1,0,0,0,0,1,1,0,0)
code128[65]=(1,0,0,1,0,1,1,0,0,0,0)
code128[66]=(1,0,0,1,0,0,0,0,1,1,0)
code128[67]=(1,0,0,0,0,1,0,1,1,0,0)
code128[68]=(1,0,0,0,0,1,0,0,1,1,0)
code128[69]=(1,0,1,1,0,0,1,0,0,0,0)
code128[70]=(1,0,1,1,0,0,0,0,1,0,0)
code128[71]=(1,0,0,1,1,0,1,0,0,0,0)
code128[72]=(1,0,0,1,1,0,0,0,0,1,0)
code128[73]=(1,0,0,0,0,1,1,0,1,0,0)
code128[74]=(1,0,0,0,0,1,1,0,0,1,0)
code128[75]=(1,1,0,0,0,0,1,0,0,1,0)
code128[76]=(1,1,0,0,1,0,1,0,0,0,0)
code128[77]=(1,1,1,1,0,1,1,1,0,1,0)
code128[78]=(1,1,0,0,0,0,1,0,1,0,0)
code128[79]=(1,0,0,0,1,1,1,1,0,1,0)
code128[80]=(1,0,1,0,0,1,1,1,1,0,0)
code128[81]=(1,0,0,1,0,1,1,1,1,0,0)
code128[82]=(1,0,0,1,0,0,1,1,1,1,0)
code128[83]=(1,0,1,1,1,1,0,0,1,0,0)
code128[84]=(1,0,0,1,1,1,1,0,1,0,0)
code128[85]=(1,0,0,1,1,1,1,0,0,1,0)
code128[86]=(1,1,1,1,0,1,0,0,1,0,0)
code128[87]=(1,1,1,1,0,0,1,0,1,0,0)
code128[88]=(1,1,1,1,0,0,1,0,0,1,0)
code128[89]=(1,1,0,1,1,0,1,1,1,1,0)
code128[90]=(1,1,0,1,1,1,1,0,1,1,0)
code128[91]=(1,1,1,1,0,1,1,0,1,1,0)
code128[92]=(1,0,1,0,1,1,1,1,0,0,0)
code128[93]=(1,0,1,0,0,0,1,1,1,1,0)
code128[94]=(1,0,0,0,1,0,1,1,1,1,0)
code128[95]=(1,0,1,1,1,1,0,1,0,0,0)
code128[96]=(1,0,1,1,1,1,0,0,0,1,0)
code128[97]=(1,1,1,1,0,1,0,1,0,0,0)
code128[98]=(1,1,1,1,0,1,0,0,0,1,0)
code128[99]=(1,0,1,1,1,0,1,1,1,1,0)
code128[100]=(1,0,1,1,1,1,0,1,1,1,0)
code128[101]=(1,1,1,0,1,0,1,1,1,1,0)
code128[102]=(1,1,1,1,0,1,0,1,1,1,0)
code128[103]=(1,1,0,1,0,0,0,0,1,0,0)
code128[104]=(1,1,0,1,0,0,1,0,0,0,0)
code128[105]=(1,1,0,1,0,0,1,1,1,0,0)
code128_STOP=(1,1,0,0,0,1,1,1,0,1,0,1,1)

def genCode128(data):
	seq=[]
	seq.extend(code128[a['START_A']])
	checksum=a['START_A']
	n=1
	for byte in data:
		seq.extend(code128[a[byte]])
		checksum+=a[byte]*n
		n+=1
	seq.extend(code128[checksum%103])
	seq.extend(code128_STOP)
	img = zeros([len(seq)+10,50,3],dtype=np.uint8)
	for i in range(0, 5):
		img[i].fill(255)
	for i in range(len(seq)+5, len(seq)+10):
		img[i].fill(255)
	for i in range(0, len(seq)):
		img[i+5].fill((1-seq[i])*255)
	return np.rot90(img, k=1, axes=(0, 1))

imsave("Result.jpg", genCode128(['H','E','L','L','O',',',' ', 'W', 'O','R','L','D', '!']))
